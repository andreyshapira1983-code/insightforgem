<!doctype html>
<html lang="ru">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Multi-Agents ¬∑ DEMO</title>
<style>
  body{margin:0;padding:20px;font-family:system-ui,Arial,sans-serif;background:#0b1220;color:#e6edf3}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;max-width:1100px;margin:0 auto}
  .card{background:#0f172a;border-radius:14px;box-shadow:0 8px 28px rgba(0,0,0,.35);padding:14px}
  input,textarea,button{width:100%;padding:10px;border-radius:10px;border:1px solid #1f2a44;background:#0d1328;color:#e6edf3}
  button{border:0;background:#2563eb;cursor:pointer;font-weight:600}
  pre{background:#0d1328;padding:10px;border-radius:10px;overflow:auto;max-height:220px}
  .muted{opacity:.8;font-size:12px}
</style>
<h2>üß© 6 –∞–≥–µ–Ω—Ç–æ–≤ (DEMO-friendly)</h2>
<p class="muted">–ë–µ–∑ –∫–ª—é—á–∞ ‚Äî –æ—Ñ–ª–∞–π–Ω DEMO. –ü–æ—Å—Ç–∞–≤–∏—à—å <code>OPENAI_API_KEY</code> ‚Äî –ø–æ–π–¥—É—Ç –æ—Ç–≤–µ—Ç—ã GPT-4o. –ü—Ä–∏ 401/429 –±—É–¥–µ—Ç –º—è–≥–∫–∏–π —Ñ–æ–ª–±—ç–∫ –≤ DEMO.</p>

<div class="grid">
  <div class="card">
    <h3>Guard</h3>
    <textarea id="g_text" placeholder="–¢–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏"></textarea>
    <button onclick="call('guard','filter',{text: val('g_text')},'g_out')">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
    <pre id="g_out">‚Äì</pre>
  </div>

  <div class="card">
    <h3>Generator</h3>
    <input id="gen_topic" placeholder="–¢–µ–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–ª–æ–º–∞—Ä—à—Ä—É—Ç—ã)" />
    <button onclick="call('generator','generate',{topic: val('gen_topic')},'gen_out')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
    <pre id="gen_out">‚Äì</pre>
  </div>

  <div class="card">
    <h3>Judge</h3>
    <textarea id="j_idea" placeholder="–ò–¥–µ—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏"></textarea>
    <button onclick="call('judge','score',{idea: val('j_idea')},'j_out')">–û—Ü–µ–Ω–∏—Ç—å</button>
    <pre id="j_out">‚Äì</pre>
  </div>

  <div class="card">
    <h3>Designer</h3>
    <input id="d_h" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" />
    <input id="d_s" placeholder="–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫" />
    <input id="d_c" placeholder="CTA" />
    <button onclick="call('designer','rewrite',{heading:val('d_h'), sub:val('d_s'), cta:val('d_c')},'d_out')">–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å</button>
    <pre id="d_out">‚Äì</pre>
  </div>

  <div class="card">
    <h3>Researcher</h3>
    <input id="r_q" placeholder="–ó–∞–ø—Ä–æ—Å (—Ç–µ–º–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è)" />
    <button onclick="call('researcher','research',{query: val('r_q')},'r_out')">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å</button>
    <pre id="r_out">‚Äì</pre>
  </div>

  <div class="card">
    <h3>Manager (–æ—Ä–∫–µ—Å—Ç—Ä)</h3>
    <input id="m_topic" placeholder="–¢–µ–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–ª–æ–º–∞—Ä—à—Ä—É—Ç—ã)" />
    <button onclick="call('manager','orchestrate',{topic: val('m_topic')},'m_out')">–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞–π–ø–ª–∞–π–Ω</button>
    <pre id="m_out">‚Äì</pre>
  </div>
</div>

<script>
  const post = (url,data)=>fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)}).then(r=>r.text().then(t=>({s:r.status,t})));
  const val = id => document.getElementById(id).value.trim();
  function call(agent, action, payload, outId){
    const out = document.getElementById(outId); out.textContent = '‚Ä¶';
    post('/.netlify/functions/agents', {agent, action, payload}).then(({s,t})=>{
      try{
        const j = JSON.parse(t);
        out.textContent = JSON.stringify(j, null, 2);
      }catch{ out.textContent = 'HTTP '+s+'\\n'+t; }
    }).catch(e=> out.textContent = 'ERR '+e.message);
  }
</script>
</html>
